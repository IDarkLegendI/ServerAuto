Я думаю, что требует внимание следующее:
— необходимо проверить наличие jsonData["type"] и других ключей перед использованием,
— добавить проверки на пустые строки и диапазоны индексов,
— упростить повторяющийся код, создав функцию для публикации сообщений.